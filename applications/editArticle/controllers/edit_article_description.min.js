!function(i,t,e,s,n){"use strict";main=n.main||{},main.ArticleDescriptionModel=t.Model.extend({url:s.set_path("/admin/get-article-data")}),main.ArticleDescriptionView=t.View.extend({tagName:"article",className:"article_description_container",template:e.template(i("#article_description_template").html()),defaults:{Model:main.ArticleDescriptionModel,url_handler:"/admin/save-article-data"},initialize:function(){var t=this;this.options=e.extend({},this.defaults,this.options),this.settings_deferred=i.getJSON(s.set_path("applications/image_settings.json")),this.settings_deferred.done(function(e){t.settings=i.extend({},e.defaults,e.edit_image)}),this.model=this.options.model||new this.options.Model,this.model.on("change",function(){t.settings_deferred.done(function(){t.render()})},this),"undefined"==typeof this.options.model&&this.model.fetch({data:{edit_url:n.location.pathname,data_group:"description"}})},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$textarea_description=this.$el.find(".textarea_description"),this.$article_description=this.$el.find(".description"),this.$edit_buttons=this.$el.find(".save_article_description, .cancel_article_description"),this.$edit_article_description=this.$el.find(".edit_article_description"),this.$article_description_status=this.$el.find(".article_description_status"),this.$article_description_done=this.$el.find(".article_description_done"),this.$article_description_error=this.$el.find(".article_description_error"),this.$article_description_uploading=this.$el.find(".article_description_uploading"),this.fix_textarea_size(),this},fix_textarea_size:function(){var i=new s.Breakpoints(this.settings);return this.$textarea_description.css({"max-width":i.width-16+"px"}),this.$article_description.height(this.$textarea_description.height()).width(this.$textarea_description.width()),this},events:{"click .edit_article_description":"show_info_and_buttons","click .cancel_article_description":"hide_info_and_buttons","click .save_article_description":"save_description"},show_info_and_buttons:function(){this.$article_description_status.css("display","none"),this.$edit_buttons.css("display","inline"),this.$article_description.prop("readonly",!1).css({"background-color":"white",border:".1em solid lightgray"}),this.$edit_article_description.css("display","none")},hide_info_and_buttons:function(){this.$article_description_status.css("display","none"),this.$edit_buttons.css("display","none"),this.$article_description.prop("readonly",!0).css({"background-color":"transparent",border:"1px solid transparent"}),this.$edit_article_description.css("display","inline")},save_description:function(){var t,e=this;this.$article_description_status.css("display","none"),this.$article_description_uploading.css("display","inline-block"),this.model.set("description",this.$article_description.val()),t=i.post(s.set_path(this.options.url_handler),this.model.toJSON()),t.done(function(){e.hide_info_and_buttons(),e.$article_description_done.css("display","inline-block")}).fail(function(){e.hide_info_and_buttons(),e.$article_description_error.css("display","inline-block")})}}),"undefined"==typeof jasmine&&i(function(){main.article_desc_view=new main.ArticleDescriptionView,main.article_desc_view.$el.appendTo("#content").after(" ")}),n.main=main}(jQuery,Backbone,_,helpers,window);