!function(t,i,s,e,a){"use strict";var n=e.main||{};n.ArticleDataModel=t.Model.extend({url:s.set_path("/admin/get-article-data")}),n.SwitcherButton=function(){function t(t){var i={className:".switcher_button",container:a,on:!1};this.settings=$.extend({},i,t),this.$container=this.settings.container||$(this.settings.className),this.$status=this.$container.find(".status"),this.$switch_button=this.$container.find(".switch_button"),this.$on_label=this.$container.find(".on_label"),this.$off_label=this.$container.find(".off_label"),this.$switch_slider=this.$container.find(".switch_slider"),this._switch_button_width=this.$switch_button.outerWidth(),this._container_width=this.$container.innerWidth(),this._distance=this._container_width-this._switch_button_width,this._click_callbacks=[],this.__init__()}return t.prototype.__init__=function(){var t=this;this._set_default_state(),this.$switch_button.on("click",function(){t._switch_state()})},t.prototype.add_click_callback=function(t){return this._click_callbacks.push(t),this},t.prototype._set_default_state=function(){this.settings.on?this.$switch_slider.css({left:0}):this.$switch_slider.css({left:-this._distance+"px"})},t.prototype._switch_state=function(){function t(){i._run_callbacks()}var i=this;this.settings.on=!this.settings.on,this.settings.on?this.$switch_slider.animate({left:0},"fast",t):this.$switch_slider.animate({left:-this._distance+"px"},"fast",t)},t.prototype._run_callbacks=function(){if("undefined"==typeof this._click_callbacks)return console.log(a),void 0;var t=0,i=this._click_callbacks.length;if(i)for(t;i>t;t++)this._click_callbacks[t]()},t}(),n.ArticleDataView=t.View.extend({tagName:"article",id:"article_data_container",template:i.template($("#article_data_template").html()),defaults:{Model:n.ArticleDataModel},initialize:function(){var t=this;this.options=i.extend({},this.defaults,this.options),this.settings_deferred=$.getJSON(s.set_path("applications/image_settings.json")),this.settings_deferred.done(function(i){t.settings=$.extend({},i.defaults,i.edit_image)}),this.model=new this.options.Model,this.model.on("change",function(){t.settings_deferred.done(function(){t.render()})},this),this.fetch_deferred=this.model.fetch({data:{edit_url:e.location.pathname,data_group:"info"}}),this.$el.appendTo("#content").after(" ")},render:function(){this.$el.html(this.template(this.model.toJSON()));var t=new s.Breakpoints(this.settings),i=this;return this.$el.css({width:t.width+"px"}),this.$input_text=this.$el.find('input[type="text"]'),this.$classification=this.$el.find("#classification"),this.$country=this.$el.find("#country"),this.$state=this.$el.find("#state"),this.$city=this.$el.find("#city"),this.$autor=this.$el.find("#autor"),this.$colaborators=this.$el.find("#colaborators"),this.$project_date=this.$el.find("#project_date"),this.$edit_buttons=this.$el.find("#save_article_data, #cancel_article_data"),this.$edit_article_data=this.$el.find("#edit_article_data"),this.$article_data_status=this.$el.find(".article_data_status"),this.$article_status_done=this.$el.find(".article_data_done"),this.$article_status_error=this.$el.find(".article_data_error"),this.$article_status_uploading=this.$el.find(".article_data_uploading"),this.article_visibility=new n.SwitcherButton({on:this.model.get("public"),element:this.$el.find(".switcher_button")}),this.article_visibility.add_click_callback(function(){i.model.set({"public":i.article_visibility.settings.on}),i.save_info_fields()}),this},events:{"click #edit_article_data":"show_info_and_buttons","click #cancel_article_data":"hide_info_and_buttons","click #save_article_data":"save_info_fields"},show_info_and_buttons:function(){this.$article_data_status.css("display","none"),this.$edit_buttons.css("display","inline"),this.$input_text.prop("readonly",!1).css({"background-color":"white",border:".1em solid lightgray"}),this.$edit_article_data.css("display","none")},hide_info_and_buttons:function(){this.$article_data_status.css("display","none"),this.$edit_buttons.css("display","none"),this.$input_text.prop("readonly",!0).css({"background-color":"transparent",border:"1px solid transparent"}),this.$edit_article_data.css("display","inline")},save_info_fields:function(){var t,i=this;this.$article_data_status.css("display","none"),this.$article_status_uploading.css("display","inline-block"),this.model.set({classification:this.$classification.val(),country:this.$country.val(),state:this.$state.val(),city:this.$city.val(),autor:this.$autor.val(),colaborators:this.$colaborators.val(),project_date:this.$project_date.val()}),t=$.post(s.set_path("/admin/save-article-data"),this.model.toJSON()),t.done(function(){i.hide_info_and_buttons(),i.$article_status_done.css("display","inline-block")}).fail(function(){i.hide_info_and_buttons(),i.$article_status_error.css("display","inline-block")})}}),"undefined"==typeof jasmine&&$(function(){n.article_data_view=new n.ArticleDataView}),e.main=n}(Backbone,_,helpers,window);